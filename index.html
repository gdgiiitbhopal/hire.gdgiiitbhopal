<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./icon.png" type="image/x-icon">
    <title>GDG Hiring</title>
    <link href="google-sans.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #ffffff;
            font-family: GoogleSansRegular, sans-serif;
            color: #202124;
            --google-red: #ea4335;
            --google-green: #34a853;
            --google-blue: #4285f4;
            --google-yellow: #f9ab00;
        }

        .overlay {
            left: 0;
            top: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100vw;
            height: 100vh;
            position: fixed;
            background-color: #ffffff;
            z-index: 1000;
        }

        .overlay-dim {
            left: 0;
            top: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100vw;
            height: 100vh;
            position: fixed;
            background-color: transparent;
            z-index: 1000;
        }

        .overlay-dim::before {
            left: 0;
            top: 0;
            display: flex;
            content: "";
            align-items: center;
            justify-content: center;
            width: 100vw;
            height: 100vh;
            position: fixed;
            background-color: #ffffff;
            opacity: 0.5;
        }

        .main-nav {
            background-color: #ffffff;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #202124;
            font-weight: 500;
            font-size: 1.3em;
            border-bottom: 1px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 999;
            gap: 10px;
        }

        .main-nav img {
            height: 40px;
            width: auto;
        }

        .section-content {
            max-width: 900px;
            margin: 1em auto;
            padding: 0 1em;
            display: grid;
            grid-template-columns: 1fr;
            grid-gap: 1.5em;
        }

        .section-content article:first-child {
            position: relative;
            padding: 2em;
            border-radius: 8px;
            text-align: center;
            color: white;
            overflow: hidden;
            height: 23vh;
            display: flex;
            align-items: center;
            justify-content: center;
            grid-column: 1 / -1;
        }

        .section-content article:first-child::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('./back-banner.png');
            background-size: cover;
            background-position: center;
            filter: brightness(0.8) contrast(1.2) saturate(1.5);
            z-index: -1;
            border-radius: 8px;
        }

        .section-content article:not(:first-child) {
            background-color: #f8f9fa;
            padding: 2em;
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.2);
            box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.08),
                0 2px 4px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: all 0.2s ease;
        }

        .section-content article:not(:first-child):hover {
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.08),
                0 3px 6px rgba(0, 0, 0, 0.12);
        }

        .section-content h2 {
            color: #202124;
            font-weight: 500;
            margin-bottom: 1em;
            font-size: 1.25em;
        }

        .section-content input,
        .section-content select,
        .section-content textarea {
            width: 100%;
            padding: 0.7em 1em;
            margin-bottom: 1em;
            border-radius: 20px;
            border: 1px solid #dadce0;
            font-size: 1em;
            transition: all 0.2s ease;
            box-shadow: inset 0 1px 2px rgba(60, 64, 67, 0.1);
            box-sizing: border-box;
        }

        .section-content select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-color: white;
        }

        .section-content textarea {
            min-height: 120px;
            resize: vertical;
            border-radius: 12px;
        }

        .section-content input:focus,
        .section-content select:focus,
        .section-content textarea:focus {
            outline: none;
            border: 2px solid #4285f4;
            box-shadow: 0 1px 3px rgba(66, 133, 244, 0.3);
        }

        .section-content input[type="submit"] {
            background-color: #4285f4;
            color: white;
            border: none;
            padding: 0.8em 2em;
            font-size: 1em;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(60, 64, 67, 0.15);
        }

        .section-content input[type="submit"]:hover {
            background-color: #3367d6;
            box-shadow: 0 2px 4px rgba(60, 64, 67, 0.2);
        }

        #typing-text {
            font-size: 2.5em;
            font-weight: 500;
            margin-bottom: 2em;
            border-right: 2px solid white;
            animation: blink 1s step-end infinite;
            color: white;
        }

        @keyframes blink {
            50% {
                border-color: transparent;
            }
        }

        @media (min-width: 768px) {
            .section-content {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {

            .section-content input,
            .section-content select,
            .section-content textarea {
                width: 100%;
            }

            .main-nav {
                height: auto;
                padding: 10px 0;
                gap: 5px;
            }
        }
    </style>
</head>

<body>
    <!-- Overlay Loader -->
    <div class="overlay">
        <div class="animation-container" id="container">
            <div name="red" class="child-animation child-red-load" id="logo-child-1"></div>
            <div name="green" class="child-animation child-green-load" id="logo-child-2"></div>
            <div name="blue" class="child-animation child-blue-load" id="logo-child-3"></div>
            <div name="yellow" class="child-animation child-yellow-load" id="logo-child-4"></div>
        </div>
    </div>

    <!-- Navbar -->
    <header class="main-nav">
        <img src="docs.png" alt="GDG Logo">
        <span>Google Developer Group</span>
    </header>

    <!-- Main Content -->
    <section class="section-content">
        <article class="club-details">
            <div class="message-box">
                <span id="typing-text">We Are Hiring!</span>
            </div>
        </article>

        <!-- Personal Details -->
        <article>
            <h2>Personal Details</h2>
            <input type="text" placeholder="Full Name" required id="fullName">
            <input type="email" placeholder="Email" required id="email">
            <input type="tel" placeholder="Phone Number" required id="phone">
        </article>

        <!-- Academic Details -->
        <article>
            <h2>Academic Details</h2>
            <select id="year" required>
                <option value="">Select Year</option>
            </select>
            <input type="text" id="scholar" placeholder="Scholar Number" required>
            <select id="branch" required>
                <option value="">Select Branch</option>
            </select>
        </article>

        <!-- Club Details -->
        <article>
            <h2>Club Details</h2>
            <select id="position1" required>
                <option value="">Position Option 1</option>
            </select>
            <select id="position2" required>
                <option value="">Position Option 2</option>
            </select>
            <textarea id="remarks" maxlength="500" placeholder="Why should we hire you? (max 500 words)"></textarea>
        </article>

        <!-- Upload Details -->
        <article>
            <h2>Upload Your Resume</h2>
            <p>Max 100KiB</p>
            <input type="file" id="resume" accept=".pdf,.doc,.docx" required placeholder="max 100kb">

            <input type="submit" value="Submit" id="submitBtn">
        </article>
    </section>

    <!-- Typing Effect -->
    <script>
        let message_element = document.querySelector("#typing-text");
        let messages = [" We Are Hiring! ", " connect with us "];
        let msg_index = 0;
        let direction = 1;
        let curr_index = 0;
        const typer = () => {
            const subStr = messages[curr_index].substring(0, msg_index);
            msg_index += direction;
            if (msg_index == messages[curr_index].length || msg_index == 0) {
                if (msg_index == 0) curr_index = (curr_index + 1) % messages.length;
                direction = -direction;
                setTimeout(typer, 2000);
            } else {
                setTimeout(typer, 100);
            }
            message_element.textContent = subStr;
        }
        typer();
    </script>

    <!-- Loader -->
    <script>
        document.body.style.overflow = 'hidden';
        let children = document.querySelectorAll(".child-animation");
        let container = document.getElementById("container");
        let isLoading = true;
        let loading_finish = false;

        const switch_state = () => {
            children.forEach((child) => {
                const colorName = child.getAttribute("name") || "none";
                child.classList.toggle(`child-${colorName}`);
                child.classList.toggle(`child-${colorName}-load`);
            });
            if (isLoading) container.classList.remove("spin");
            else container.classList.add("spin");
            isLoading = !isLoading;

            if (loading_finish) {
                clearInterval(timer);
                document.body.style.overflow = 'auto';
                document.querySelector(".overlay").style.display = "none";
            }
        };

        setTimeout(() => { loading_finish = true; }, 5000);
        container.classList.add("spin");
        const timer = setInterval(switch_state, 1000);
    </script>

    <!-- Dynamic Dropdowns & Validations -->
    <script>
        const yearData = {
            2024: {
                name: 'B.Tech 2028',
                branches: ['Computer Science and Engineering (Core)', 'CSE AI & DS', 'CSE Cybersecurity', 'CSE Cyber Physical Systems', 'Information Technology', 'Electronics and Communication Engineering'],
                positions: ['Asst. Management Lead', 'Asst. PR & Outreach Lead', 'Asst. GenAI Lead', 'Asst. Cloud Lead', 'Asst. Web-Dev Lead', 'Asst. AI-ML Lead', 'Asst. Data Science Lead', 'Asst. Graphic Designer', 'Asst. App-Dev Lead', 'Event Coordinator', 'Content Writer']
            },
            2023: {
                name: 'B.Tech 2027',
                branches: ['Computer Science and Engineering', 'Electronics and Communication Engineering', 'Information Technology'],
                positions: ['Co-Lead', 'Management Lead', 'PR & OutReach Lead', 'GenAI Lead', 'Cloud Lead', 'Web-Dev Lead', 'AI/ML Lead', 'Data Science Lead', 'Graphic Designer', 'App-Dev Lead']
            }
        };

        const yearSelect = document.getElementById("year");
        const branchSelect = document.getElementById("branch");
        const pos1 = document.getElementById("position1");
        const pos2 = document.getElementById("position2");
        const resume = document.getElementById("resume");
        const nameInput = document.getElementById("fullName");
        const emailInput = document.getElementById("email");
        const scholarInput = document.getElementById("scholar");
        const remarksInput = document.getElementById("remarks");
        const phoneInput = document.getElementById("phone");
        const submitBtn = document.getElementById("submitBtn");

        // Populate years
        Object.keys(yearData).forEach(key => {
            const opt = document.createElement("option");
            opt.value = key;
            opt.textContent = yearData[key].name;
            yearSelect.appendChild(opt);
        });

        // Update branches & positions
        yearSelect.addEventListener("change", e => {
            const val = e.target.value;
            branchSelect.innerHTML = '<option value="">Select Branch</option>';
            pos1.innerHTML = '<option value="">Position Option 1</option>';
            pos2.innerHTML = '<option value="">Position Option 2</option>';
            if (val && yearData[val]) {
                yearData[val].branches.forEach(b => {
                    let opt = document.createElement("option");
                    opt.value = b;
                    opt.textContent = b;
                    branchSelect.appendChild(opt);
                });
                yearData[val].positions.forEach(p => {
                    let opt1 = document.createElement("option");
                    opt1.value = p;
                    opt1.textContent = p;
                    pos1.appendChild(opt1);
                    let opt2 = document.createElement("option");
                    opt2.value = p;
                    opt2.textContent = p;
                    pos2.appendChild(opt2);
                });
            }
        });

        // Exclusive positions
        function syncPositions(changed, other) {
            const selected = changed.value;
            [...other.options].forEach(opt => {
                opt.hidden = (opt.value && opt.value === selected);
            });
        }
        pos1.addEventListener("change", () => syncPositions(pos1, pos2));
        pos2.addEventListener("change", () => syncPositions(pos2, pos1));

        // Validation
        const namePattern = /^[A-Za-z ]+$/;
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        const scholarPattern = /^(23|24)[UP]\d+$/i;

        function validateInput(input, pattern) {
            if (input.value.trim() === "") {
                input.style.borderColor = "#dadce0";
                return false;
            }
            if (!pattern.test(input.value.trim())) {
                input.style.borderColor = "red";
                return false;
            } else {
                input.style.borderColor = "#4285f4";
                return true;
            }
        }

        nameInput.addEventListener('input', () => validateInput(nameInput, namePattern));
        emailInput.addEventListener('input', () => validateInput(emailInput, emailPattern));
        scholarInput.addEventListener('input', () => validateInput(scholarInput, scholarPattern));

        // File check
        resume.addEventListener("change", e => {
            const file = resume.files[0];
            if (file && file.size > 100 * 1024) {
                alert("Resume must be ≤ 100KB");
                resume.value = "";
                resume.style.borderColor = "red";
            } else if (file) {
                resume.style.borderColor = "#4285f4";
            }
        });

        // Submit: no form, just alert
        submitBtn.addEventListener('click', async e => {
            e.preventDefault();

            // Validate inputs
            let validName = validateInput(nameInput, namePattern);
            let validEmail = validateInput(emailInput, emailPattern);
            let validScholar = validateInput(scholarInput, scholarPattern);

            let resumeFile = resume.files[0];
            if (!validName || !validEmail || !validScholar || !resumeFile || resumeFile.size > 100 * 1024) {
                alert("Please fix errors before submitting!");
                return;
            }

            // Show overlay loader
            const overlay = document.querySelector(".overlay");

            overlay.classList.remove("overlay");
            overlay.classList.add("overlay-dim");

            overlay.style.display = "flex";
            overlay.style.background = "transparent";
            document.body.style.overflow = "hidden";

            // Keep loader spinning like on page load
            let loading_finish = false;
            let isLoading = true;
            const switch_state = () => {
                children.forEach((child) => {
                    const colorName = child.getAttribute("name") || "none";
                    child.classList.toggle(`child-${colorName}`);
                    child.classList.toggle(`child-${colorName}-load`);
                });
                if (isLoading) container.classList.remove("spin");
                else container.classList.add("spin");
                isLoading = !isLoading;
            };
            const timer = setInterval(switch_state, 1000);
            // Prepare form data
            const formData = new FormData();
            formData.append("full_name", nameInput.value.trim());
            formData.append("email", emailInput.value.trim());
            formData.append("phone", phoneInput.value.trim());
            formData.append("year", yearSelect.value);
            formData.append("branch", branchSelect.value);
            formData.append("scholar_no", scholarInput.value.trim());
            formData.append("position1", pos1.value);
            formData.append("position2", pos2.value);
            formData.append("remarks", remarksInput.value.trim());
            formData.append("resume", resumeFile);

            try {
                const response = await fetch("https://gdgiiitbhpl.pythonanywhere.com/submit", {
                    method: "POST",
                    body: formData
                });

                const data = await response.json();

                // Stop loader animation
                clearInterval(timer);

                overlay.classList.add("overlay");
                overlay.classList.remove("overlay-dim");

                // Show response popup
                const popup = document.createElement("div");
                popup.style.position = "absolute";
                popup.style.top = "50%";
                popup.style.left = "50%";
                popup.style.transform = "translate(-50%, -50%)";
                popup.style.padding = "2em";
                popup.style.background = "#fff";
                popup.style.border = "2px solid #4285f4";
                popup.style.borderRadius = "10px";
                popup.style.boxShadow = "0 2px 10px rgba(0,0,0,0.3)";
                popup.style.zIndex = 2000;
                popup.style.textAlign = "center";

                const msg = document.createElement("p");
                msg.textContent = data.status === "success" ? "Submission Successful!" : `Error: ${data.message}`;
                popup.appendChild(msg);

                const okBtn = document.createElement("button");
                okBtn.textContent = "OK";
                okBtn.style.marginTop = "1em";
                okBtn.style.padding = "0.5em 1em";
                okBtn.style.border = "none";
                okBtn.style.backgroundColor = "#4285f4";
                okBtn.style.color = "#fff";
                okBtn.style.borderRadius = "5px";
                okBtn.style.cursor = "pointer";

                okBtn.addEventListener("click", () => {
                    popup.remove();
                    overlay.style.display = "none";
                    document.body.style.overflow = "auto";

                    if (data.status === "success") {
                        message_element.textContent = "Thank you, We Will Contact Soon";
                        // Reset form
                        nameInput.value = "";
                        emailInput.value = "";
                        phoneInput.value = "";
                        scholarInput.value = "";
                        yearSelect.value = "";
                        branchSelect.innerHTML = '<option value="">Select Branch</option>';
                        pos1.innerHTML = '<option value="">Position Option 1</option>';
                        pos2.innerHTML = '<option value="">Position Option 2</option>';
                        remarksInput.value = "";
                        resume.value = "";
                    }
                });

                popup.appendChild(okBtn);
                overlay.appendChild(popup);

            } catch (err) {
                clearInterval(timer);
                overlay.style.display = "none";
                document.body.style.overflow = "auto";
                console.error(err);
                alert("Server error. Check console for details.");
            }
        });

    </script>
</body>

</html>